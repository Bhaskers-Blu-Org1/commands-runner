---
bmxconfig:

  #Top Level Administrator ID for Cloud Foundry
  main_user_name: (( grab uiconfig.main_user_name ))
  main_user_password: (( grab uiconfig.main_user_password ))

  ## This value depends on the certificate that is being used and the domain used in that certificate
  #Management domain for the environment
  bluemix_env_domain: (( grab uiconfig.bluemix_env_domain ))
  #Default customer application domain
  bluemix_apps_domain: (( grab uiconfig.bluemix_apps_domain ))
  #Diego Cell 32GB count
  diego_cell_instances: (( grab uiconfig.diego_cell_instances ))

  ## Array of entries. Use value from IBM PureApplication, IP Group (Customer network) Primary DNS.
  external_dns: (( grab uiconfig.external_dns_yaml_formated ))

  #NTP Server listen_address
  ntp_servers: (( grab uiconfig.ntp_servers_yaml_formated ))

  ## VMware Setup
  vmware:
    #vCenter hostname or IP Address
    address: (( grab uiconfig.vmware_address ))
    #vCenter username for connecting to the API
    user: (( grab uiconfig.vmware_username ))
    #vCenter user password for connecting to the API
    password: (( grab uiconfig.vmware_password ))

    datacenters:
    # -name: DATACENTER_NAME  Should be exactly as seen in the vSphere client
    - name: (( grab uiconfig.datacenter_name ))
      #Folder name to create, that holds all VM's in the Virtual Machine & Templates view. Recommended to use Cluster Name
      vm_folder: (( grab uiconfig.vm_folder ))
      #Folder name to create, that holds all Stemcells (VMware templates) in the Virtual Machine & Templates view. Recommended to use Cluster Name
      template_folder: (( grab uiconfig.template_folder ))
      #Directory on the datastore(s) associated to persistent_datastore_pattern. Persistent disks (vmkd's) are stored here.
      disk_path: (( grab uiconfig.disk_path ))
      #Pattern used to define datastores where VM's are placed. '^mydatastore$' will put VM files only on a datastore named "mydatastore".
      #A star * can be used as a wildcard suffix.  mydatastore0* would include mydatastore01, mydatastore02....mydatastore09
      datastore_pattern: (( grab uiconfig.datastore_pattern ))
      #Same pattern type as above, but used to hold the persistent disks (vmdk's). They are placed in the directork "disk_path" above
      persistent_datastore_pattern: (( grab uiconfig.persistent_datastore_pattern ))
      #Replace CLUSTER_NAME and RESOURCE_POOL_NAME with the values you see in the vSphere Client.
      #clusters: [{CLUSTER_NAME: {resource_pool: RESOURCE_POOL_NAME}}]
      #If no resource pool is available
      #clusters: [{CLUSTER_NAME: {resource_pool: Resources}}]
      clusters: (( grab uiconfig.clusters_concat ))

  ## Network Setup

  #SUBNET with slash notation. ie:  subnet: 10.155.194.129/27
  subnet: (( grab uiconfig.subnet ))

  #IP Address to be used by the director. It is recommended to use the first IP after the gateway.
  director_ip: (( grab uiconfig.director_ip ))

  networks:
  - name: default
    type: manual
    subnets:
    - range: (( grab bmxconfig.subnet ))
      gateway:
      dns: (( grab bmxconfig.external_dns ))
      reserved: (( grab uiconfig.reserved_calculated ))
      cloud_properties:
        #Portgroup name to be used for the deployment. If using a Virtual Distributed Switch in a folder, include the folder name.
        #ie. name: dev02/local-proxy-dev02-priv         Where dev02 is a folder name and local-proxy-dev02-priv is the portgroup name.
        name: (( grab uiconfig.portgroup ))
    static_ips: [ (( grab bmxconfig.director_ip )) ]
    default: [dns, gateway]

  # comma separated domain search list for Bosh VMs - OPTIONAL
  #mod_vms_domain_searchlist:
  # comma separated domain search list for Director VM - OPTIONAL
  #mod_vms_director_domain_searchlist:

  ######
  # GENERATED BY AUTOMATION
  #####
  #Comes from the director deployment "bosh status"
  director_uuid: ""
  #Default is 1
  bluemix_env_max_in_flight: 1
  #Run jobs serially
  bluemix_env_run_jobs_serial: true
  #Director IP

  #Unbound DNS, replace CUSTOMER_DNS with a list of DNS servers (each on their own line with a dash prefix)
  unbound_forward_zones:
  - forward-addrs: (( grab bmxconfig.external_dns ))
    name: .

  #When closer to launch this needs to be moved to the template (NO POWERDNS)
  unbound_stub_zones:
    - name: microbosh
      stub-addr: (( grab bmxconfig.director_ip ))

  ccng_admin_bootstrap_email: (( grab bmxconfig.main_user_name ))

##LDAP Setup
#Rename NOT_USED_properties to "properties" to activate this stanza
NOT_USED_properties:
  loginserver:
  - type: LDAP
    id: CUSTOMER_LDAP
    default: true
    cliSearchOrder: 20
    group: customers
    LDAP:
      url: #ldaps://ldapserver.mycompany.com
      userId: #LDAP credential User Name
      password: #LDAP credential User password
      objCls: person
      userNameAttr: uid
      mailAttr: mail
      firstNameAttr: givenName
      lastNameAttr: sn
      searchCtx: o=group
      grpObjCls: groupOfNames
      grpNameAttr: cn
      grpMemberAttr: member
      grpSearchCtx: o=group
      expressions:
        checkLoginUser: #OPTIONAL
        checkSearchUsers: #OPTIONAL
        checkSearchGroups: #OPTIONAL
  - UAA:
    usersPattern: .* #Fuzzy username pattern match
    usersList: estado_user, mccp_user, bss_user, console_user #Fixed usernames
    group: operators
    default: true
    id: UAA
    type: UAA
    cliSearchOrder: 10 #Lower value, gives less priority to this check
  #auditingHostPort: (( concat bmxconfig.logstash_ip ":5517" ))
  #auditingKeystore: (( grab bmxconfig.logstash_base64_client_jceks || nil ))
  #auditingKeystoreSecret: (( grab bmxconfig.logstash_key_password || nil ))
  #auditingOverSSL: false
